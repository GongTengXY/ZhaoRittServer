{"version":3,"file":"js/397-legacy.3a2af1a1.js","mappings":"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","sources":["webpack://hmtoutiao/./src/views/Home/index.vue?d6bd","webpack://hmtoutiao/./src/views/Home/components/channel-Edit.vue?6fd8","webpack://hmtoutiao/./src/api/channel.js","webpack://hmtoutiao/src/views/Home/components/channel-Edit.vue","webpack://hmtoutiao/./src/views/Home/components/channel-Edit.vue?5dee","webpack://hmtoutiao/./src/views/Home/components/channel-Edit.vue","webpack://hmtoutiao/./src/views/Home/components/article-list.vue?40c6","webpack://hmtoutiao/./src/components/article-item/index.vue?d1e1","webpack://hmtoutiao/src/components/article-item/index.vue","webpack://hmtoutiao/./src/components/article-item/index.vue?65ab","webpack://hmtoutiao/./src/components/article-item/index.vue","webpack://hmtoutiao/src/views/Home/components/article-list.vue","webpack://hmtoutiao/./src/views/Home/components/article-list.vue?3ac4","webpack://hmtoutiao/./src/views/Home/components/article-list.vue","webpack://hmtoutiao/src/views/Home/index.vue","webpack://hmtoutiao/./src/views/Home/index.vue?f10d","webpack://hmtoutiao/./src/views/Home/index.vue","webpack://hmtoutiao/./src/api/article.js"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home\"},[_c('van-nav-bar',{staticClass:\"page-nav-bar\",attrs:{\"fixed\":\"\"}},[_c('van-button',{staticClass:\"search_btn\",attrs:{\"slot\":\"title\",\"type\":\"info\",\"size\":\"small\",\"round\":\"\",\"icon\":\"search\",\"to\":\"/search\"},slot:\"title\"},[_vm._v(\"搜索\")])],1),_c('van-tabs',{staticClass:\"channel-tabs\",attrs:{\"animated\":\"\",\"swipeable\":\"\"},model:{value:(_vm.active),callback:function ($$v) {_vm.active=$$v},expression:\"active\"}},[_vm._l((_vm.channels),function(obj){return _c('van-tab',{key:obj.id,attrs:{\"title\":obj.name}},[_c('Article',{attrs:{\"obj\":obj}})],1)}),_c('div',{staticClass:\"placeholder\",attrs:{\"slot\":\"nav-right\"},slot:\"nav-right\"}),_c('div',{staticClass:\"more-btn\",attrs:{\"slot\":\"nav-right\"},on:{\"click\":_vm.moreChannels},slot:\"nav-right\"},[_c('i',{staticClass:\"iconfont icon-gengduo\"})])],2),_c('van-popup',{style:({ height: '100%' }),attrs:{\"closeable\":\"\",\"round\":\"\",\"close-icon-position\":\"top-left\",\"position\":\"bottom\"},model:{value:(_vm.isChannelShow),callback:function ($$v) {_vm.isChannelShow=$$v},expression:\"isChannelShow\"}},[_c('ChannelEdit',{attrs:{\"myChannels\":_vm.channels,\"active\":_vm.active},on:{\"updateActive\":_vm.onUpdateChange}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"channel-edit\"},[_c('van-cell',[_c('div',{staticClass:\"title\",attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\" 我的频道 \")]),_c('van-button',{attrs:{\"plain\":\"\",\"round\":\"\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.iconState = !_vm.iconState}}},[_vm._v(_vm._s(_vm.iconState ? '完成' : '编辑'))])],1),_c('van-grid',{attrs:{\"gutter\":10}},_vm._l((_vm.myChannels),function(value,index){return _c('van-grid-item',{key:index,staticClass:\"grid-item\",on:{\"click\":function($event){return _vm.onMyChannelBtn(value, index)}}},[_c('van-icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.iconState && !_vm.fiexdChannels.includes(value.id)),expression:\"iconState && !fiexdChannels.includes(value.id)\"}],attrs:{\"slot\":\"icon\",\"name\":\"clear\"},slot:\"icon\"}),_c('span',{class:{ activecss: index === _vm.active },attrs:{\"slot\":\"text\"},slot:\"text\"},[_vm._v(_vm._s(value.name))])],1)}),1),_c('van-cell',[_c('div',{staticClass:\"title\",attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\" 频道推荐 \")])]),_c('van-grid',{attrs:{\"gutter\":10,\"direction\":\"horizontal\"}},_vm._l((_vm.recommendChannels),function(item){return _c('van-grid-item',{key:item.id,staticClass:\"grid-itemMore\",attrs:{\"icon\":\"plus\",\"text\":item.name},on:{\"click\":function($event){return _vm.onAddChannel(item)}}})}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import request from '@/utils/request'\n\n//请求获取所有频道列表\nexport const getAllChannels = () => request({\n    method : 'get',\n    url : '/v1_0/channels',\n})\n\n//添加用户频道\nexport const addUserChannels = channel => request({\n    method : 'patch',\n    url : '/v1_0/user/channels',\n    data : {\n        channels : [channel]\n    }\n})\n\n//删除指定用户频道\nexport const deleteUserChannels = channelId => request({\n    method : 'DELETE',\n    url : `/v1_0/user/channels/${channelId}`,\n})","<template>\n  <div class=\"channel-edit\">\n    <van-cell>\n        <div slot=\"title\" class=\"title\">\n            我的频道\n        </div>\n            <van-button plain round size=\"mini\" @click=\"iconState = !iconState\">{{iconState ? '完成' : '编辑'}}</van-button>\n    </van-cell>\n    <!-- 我的频道 -->\n    <van-grid :gutter=\"10\">\n        <van-grid-item class=\"grid-item\" v-for=\"(value, index) in myChannels\" :key=\"index\" @click=\"onMyChannelBtn(value, index)\">\n            <van-icon name=\"clear\" slot=\"icon\" v-show=\"iconState && !fiexdChannels.includes(value.id)\"></van-icon>\n            <span slot=\"text\" :class=\"{ activecss: index === active }\">{{value.name}}</span>\n        </van-grid-item>\n    </van-grid>\n\n    <!-- 频道推荐 -->\n    <van-cell>\n        <div slot=\"title\" class=\"title\">\n            频道推荐\n        </div>\n    </van-cell>\n    <van-grid :gutter=\"10\" direction=\"horizontal\">\n        <van-grid-item @click=\"onAddChannel(item)\" class=\"grid-itemMore\" v-for=\"item in recommendChannels\" icon=\"plus\" :key=\"item.id\" :text=\"item.name\" />\n    </van-grid>\n  </div>\n</template>\n\n<script>\nimport { getAllChannels, addUserChannels, deleteUserChannels} from '@/api/channel.js'\nimport { mapState } from 'vuex'\nimport { setItem } from '@/utils/storage.js'\n\nexport default {\n    props: {\n        myChannels : {\n            type : Array,\n            required : true\n        },\n        active : {\n            type : Number,\n            required : true\n        }\n    },\n    data () {\n        return {\n            allChannels : [],  //存储所有频道\n            iconState : false, //控制编辑状态的显示\n            fiexdChannels : [0]  //固定频道，不允许删除\n        }\n    },\n    created () {\n        this.getChannels()\n    },\n    methods: {\n        async getChannels() {\n            try {\n                const {data} = await getAllChannels()\n                this.allChannels = data.data.channels\n                // console.log(this.allChannels)\n            } catch (err) {\n                console.log('请求失败', err)\n            }\n        },\n        async onAddChannel (channel) {\n            this.myChannels.push(channel)\n\n            //数据持久化处理：\n            if (this.user) {\n                try {\n                    //2.已登录，把用户数据请求接口放到线上\n                    await addUserChannels({\n                        id : channel.id,  //频道ID\n                        seq : this.myChannels.length,  //序号\n                    })\n                } catch (err) {\n                    this.$toast('保存失败，请稍后重试')\n                }\n            } else {\n                //1.未登录，把数据存储到本地\n                setItem('TOUTIAO_CHANNELS', this.myChannels)\n\n            }\n            \n        },\n        onMyChannelBtn (channel, index) {\n            if (this.iconState) {\n                //1.如果选择的是固定频道，那么不允许删除\n                if (this.fiexdChannels.includes(index)) {\n                    return\n                }\n                //2.删除频道项\n                this.myChannels.splice(index, 1)\n\n                //3.编辑状态，则执行删除频道\n                if (index <= this.active) {\n                    //将激活频道的索引 -1\n                    this.$emit('updateActive', this.active - 1, true)\n                }\n                //4. 处理删除持久化\n                this.deleteChannel(channel)\n            } else {\n                //4.非编辑状态，执行切换\n                this.$emit(\"updateActive\", index)\n            }\n        },\n        async deleteChannel (channel) {\n            if (this.user) {\n                //已登录，则将数据更新到线上\n                try {\n                    await deleteUserChannels(channel.id)\n                } catch (err) {\n                    this.$toast('删除失败，请稍后重试')\n                }\n            } else {\n                //未登录，将数据更新到本地\n                setItem('TOUTIAO_CHANNELS', this.myChannels)\n            }\n            // try {\n            //     if (this.user) {\n            //         //已登录，则将数据更新到线上\n            //         await deleteUserChannels(channel.id)\n            //     } else {\n            //         //未登录，将数据更新到本地\n            //         setItem('TOUTIAO_CHANNELS', this.myChannels)\n            //     }\n            // } catch (err) {\n            //     this.$toast('删除失败，请稍后重试')\n            // }\n        }\n    },\n    //利用计算属性来算剩下的推荐频道 -- 会观测内部数据的变量，如果内部数据变化了则计算属性会重新计算\n    computed: {\n        ...mapState(['user']),\n\n        recommendChannels () {\n            //第二种方法\n            return this.allChannels.filter(channel => {\n                //return后面所跟的就是filter的条件 true了就是\n                return !this.myChannels.find(mychannel => {\n                    return mychannel.id === channel.id\n                })\n            })\n\n            //第一种方法\n            // const moreChannels = []\n            // this.allChannels.forEach(obj => {\n            //     const ret = this.myChannels.find(mychannel => {\n            //         return mychannel.id === obj.id\n            //     })\n            //     //如果我的频道中不包括该频道项，则收集到推荐频道中\n            //     if (!ret) {\n            //         moreChannels.push(obj)\n            //     }\n                \n\n            // })\n            // //把计算结果返回\n            // return moreChannels\n        }\n    }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.channel-edit {\n    padding: 84px 0;\n    .van-cell {\n        .van-cell__title {\n            display: flex;\n            align-items: center;\n            .title {\n            font-size: 32px;\n            color: #333333;\n            }\n        }\n\n        .van-cell__value {\n            display: flex;\n            align-items: center;\n            justify-content: right;\n            .van-button {\n            width: 100px;\n            height: 50px;\n            font-size: 28px;\n            color: #f85c5c;\n            }\n\n            .van-button--default {\n                border-color: #f85c5c;\n            }\n        }\n    }\n    \n    /deep/ .van-grid {\n        .grid-item {\n            position: relative;\n            width: 160px;\n            height: 86px;\n            margin-top: 0;\n            .van-grid-item__content {\n                white-space: nowrap;\n                background-color: #f4f5f6;\n                .van-grid-item__text,  span {\n                    font-size: 28px;\n                    color: #222222;\n                }\n                .van-grid-item__icon-wrapper {\n                    position: unset;\n                    .van-icon {\n                        position: absolute;\n                        right: -6px;\n                        top: -8px;\n                        font-size: 28px;\n                        z-index: 2;\n                    }\n                }\n                .activecss {\n                    color: #f85c5c;\n                }\n            }\n        }\n\n        .grid-itemMore {\n            width: 160px;\n            height: 86px;\n            .van-grid-item__content {\n                white-space: nowrap;\n                background-color: #f4f5f6;\n                .van-grid-item__text {\n                    font-size: 28px;\n                    color: #222222;\n                    margin-left: 2px;\n                }\n                .van-grid-item__icon {\n                    font-size: 28px;\n                }\n            }\n        }\n    }\n}\n</style>","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./channel-Edit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./channel-Edit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./channel-Edit.vue?vue&type=template&id=0f8c5c02&scoped=true&\"\nimport script from \"./channel-Edit.vue?vue&type=script&lang=js&\"\nexport * from \"./channel-Edit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./channel-Edit.vue?vue&type=style&index=0&id=0f8c5c02&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0f8c5c02\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"article-list\"},[_c('van-pull-refresh',{attrs:{\"success-text\":_vm.newSuccessText,\"success-duration\":\"700\"},on:{\"refresh\":_vm.onRefresh},model:{value:(_vm.isNewLoading),callback:function ($$v) {_vm.isNewLoading=$$v},expression:\"isNewLoading\"}},[_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\",\"offset\":\"450\",\"error.sync\":\"error\",\"error-text\":\"请求失败，点击重新加载\"},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.list),function(item,index){return _c('ArticleItem',{key:index,attrs:{\"article\":item}})}),1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('van-cell',{attrs:{\"to\":(\"/article/\" + (_vm.article.art_id))}},[_c('div',{staticClass:\"title van-multi-ellipsis--l2\",attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(_vm._s(_vm.article.title))]),_c('div',{attrs:{\"slot\":\"label\"},slot:\"label\"},[(_vm.article.cover.type === 3)?_c('div',{staticClass:\"cover-wrap\"},_vm._l((_vm.article.cover.images),function(img,ind){return _c('div',{key:ind,staticClass:\"cover-item\"},[_c('van-image',{staticClass:\"cover-item-img\",attrs:{\"slot\":\"default\",\"fit\":\"cover\",\"src\":img},slot:\"default\"})],1)}),0):_vm._e(),_c('div',{staticClass:\"laber-info\"},[_c('span',[_vm._v(_vm._s(_vm.article.aut_name))]),_c('span',[_vm._v(_vm._s(_vm.article.comm_count)+\"条评论\")]),_c('span',[_vm._v(_vm._s(_vm._f(\"relativeTime\")(_vm.article.pubdate)))])])]),(_vm.article.cover.type === 1)?_c('van-image',{staticClass:\"right-img\",attrs:{\"slot\":\"default\",\"fit\":\"cover\",\"src\":_vm.article.cover.images[0]},slot:\"default\"}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <van-cell :to=\"`/article/${article.art_id}`\">\n        <div slot=\"title\" class=\"title van-multi-ellipsis--l2\">{{article.title}}</div>\n        <div slot=\"label\" >\n            <div v-if=\"article.cover.type === 3\" class=\"cover-wrap\">\n                <div class=\"cover-item\" v-for=\"(img,ind) in article.cover.images\" :key=\"ind\">\n                    <van-image\n                        class=\"cover-item-img\"\n                        slot=\"default\"\n                        fit=\"cover\"\n                        :src=\"img\"\n                    />\n                </div>\n            </div>\n            <div class=\"laber-info\">\n                <span>{{article.aut_name}}</span>\n                <span>{{article.comm_count}}条评论</span>\n                <span>{{article.pubdate | relativeTime}}</span>\n            </div>\n        </div>\n        <van-image\n            v-if=\"article.cover.type === 1\"\n            slot=\"default\"\n            class=\"right-img\"\n            fit=\"cover\"\n            :src=\"article.cover.images[0]\"\n        />\n    </van-cell>\n    \n</template>\n<script>\nexport default {\n    props: {\n        article : Object,\n        required : true\n    }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.title {\n    font-size: 32px;\n    color: #3a3a3a;\n}\n.van-cell__value {\n    flex: unset;\n    width: 232px;\n    height: 146px;\n    margin-left: 25px;\n}\n.right-cover {\n    width: 232px;\n    height: 146px;\n}\n.van-cell__label span{\n    font-size: 23px;\n    color: #b4b4b4;\n}\n.cover-wrap {\n    display: flex;\n    padding: 30px 0;\n    .cover-item {\n        flex: 1;\n        height: 146px;\n        &:not(:last-child) {\n            padding-right: 4px;\n        }\n        .cover-item-img {\n            width: 100%;\n            height: 146px;\n        }\n    }\n    \n}\n.laber-info {\n    span {\n        margin-right: 23px;\n    }\n}\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=06cd5370&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=06cd5370&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"06cd5370\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"article-list\">\n    <van-pull-refresh v-model=\"isNewLoading\" @refresh=\"onRefresh\" :success-text=\"newSuccessText\" success-duration=\"700\">\n        <!-- 列表 -->\n        <van-list\n            v-model=\"loading\"\n            :finished=\"finished\"\n            finished-text=\"没有更多了\"\n            offset=\"450\"\n            error.sync=\"error\"\n            error-text=\"请求失败，点击重新加载\"\n            @load=\"onLoad\"\n        >\n        <ArticleItem v-for=\"(item, index) in list\" :key=\"index\" :article=\"item\" />\n        </van-list>\n    </van-pull-refresh>\n  </div>\n</template>\n\n<script>\nimport { getArticles } from '@/api/article.js'\nimport ArticleItem from '@/components/article-item'\nexport default {\n    props: {\n        obj : {\n            type : Object,\n            required : true\n        }\n    },\n    data () {\n        return {\n            list: [],            //存储列表数据的数组\n            loading: false,      //控制加载的状态\n            finished: false,     //控制数据加载结束的状态\n            timestamp : null,   //请求下一页数据的事件戳\n            error: false,       //控制列表加载失败的提示状态\n            isNewLoading: false,  //控制下拉刷新的loading状态\n            newSuccessText : '',  //下拉刷新成功后显示\n        }\n    },\n    methods: {\n        //初始化滚动距离底部offset的值才触发调用 onload\n        async onLoad () {\n            try {\n                // 1.请求获取数据\n                const { data } = await getArticles({\n                    channel_id : this.obj.id,\n                    timestamp : this.timestamp || Date.now(),\n                })\n                const { results } = data.data\n                // 2.把请求结果数据放到list 数组中\n                this.list.push(...results)\n                // 3.本次数据加载结束之后要把加载状态loading 设置为结束\n                this.loading = false\n                // 4.判断数据是否全部加载完毕\n                if (results.length) {\n                    //更新获取下一页的时间戳\n                    this.timestamp = data.data.pre_timestamp\n                } else {\n                    //没有数据了，将finished 设置成 true， 不再触发load事件加载更多\n                    this.finished = true\n                }\n            } catch (err) {\n                this.error = true\n                //请求失败了，loading还需要关闭\n                this.loading = false\n            }\n        },\n        //下拉刷新触发调用该函数\n        async onRefresh () {\n            try {\n                //1.请求获取数据\n                const { data } = await getArticles({\n                    channel_id : this.obj.id,\n                    timestamp : Date.now(),  //下拉刷新每次获取都是最新数据\n                })\n                const results = data.data.results\n                //2.将请求的数据追加到列表的顶部\n                this.list.unshift(...results)\n                //3.关闭下拉刷新的 loading状态\n                this.isNewLoading = false\n                //下拉更新成功后显示\n                this.newSuccessText = `刷新成功，更新了${results.length}条新闻`\n            } catch (err) {\n                this.isNewLoading = false\n                this.newSuccessText = '刷新失败，请重试'\n            }\n        }                                                               \n    },\n    components: {\n        ArticleItem,\n    }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.article-list {\n    height: 79vh;\n    overflow-y: auto;\n}\n</style>","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./article-list.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./article-list.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./article-list.vue?vue&type=template&id=3b44602c&scoped=true&\"\nimport script from \"./article-list.vue?vue&type=script&lang=js&\"\nexport * from \"./article-list.vue?vue&type=script&lang=js&\"\nimport style0 from \"./article-list.vue?vue&type=style&index=0&id=3b44602c&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3b44602c\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"home\">\n      <!-- 导航栏 -->\n    <van-nav-bar class=\"page-nav-bar\" fixed>\n        <!-- 搜索栏 -->\n        <van-button class=\"search_btn\" slot=\"title\" type=\"info\" size=\"small\" round icon=\"search\" to=\"/search\">搜索</van-button>\n    </van-nav-bar>\n    <!-- 标签栏 -->\n    <van-tabs class=\"channel-tabs\" v-model=\"active\" animated swipeable>\n        <van-tab :title=\"obj.name\" v-for=\"obj in channels\" :key=\"obj.id\">\n            <!-- 文章列表组件 -->\n            <Article :obj=\"obj\"></Article>\n        </van-tab>\n        <div slot=\"nav-right\" class=\"placeholder\"></div>\n        <div slot=\"nav-right\" class=\"more-btn\" @click=\"moreChannels\">\n            <i class=\"iconfont icon-gengduo\"></i>\n        </div>\n    </van-tabs>\n    <!-- 频道列表 -->\n    <van-popup\n    v-model=\"isChannelShow\"\n    closeable\n    round\n    close-icon-position=\"top-left\"\n    position=\"bottom\"\n    :style=\"{ height: '100%' }\">\n    <ChannelEdit :myChannels=\"channels\" :active=\"active\" @updateActive=\"onUpdateChange\"></ChannelEdit>\n    </van-popup>\n  </div>\n</template>\n\n<script>\nimport { getUserChannel } from '@/api/user.js'\nimport ChannelEdit from './components/channel-Edit.vue'\nimport Article from './components/article-list.vue'\nimport { mapState } from 'vuex'\nimport { getItem } from '@/utils/storage.js'\n\nexport default {\n    name : 'Home',\n    data () {\n        return {\n            active : 0,\n            channels : [],   //标签栏内容\n            isChannelShow : false,  //控制频道弹出层的显示状态\n        }\n    },\n    computed: {\n      ...mapState(['user']) \n    },\n    components: {\n        Article,\n        ChannelEdit\n    },\n    created () {\n        this.loadUserChannel()\n    },\n    methods: {\n        async loadUserChannel() {\n            try {\n                let channels = []\n                if (this.user) {\n                    //已登录\n                    const { data }  = await getUserChannel()\n                    channels = data.data.channels\n                } else {\n                    //未登录\n                    const loacChannels = getItem('TOUTIAO_CHANNELS', )\n                    if (loacChannels) {\n                        channels = loacChannels\n                    } else {\n                        //如果本地没有数据，则让其请求默认频道列表\n                        const { data }  = await getUserChannel()\n                        channels = data.data.channels\n                    }\n                }\n                this.channels = channels\n            } catch(err) {\n                this.$toast('获取频道数据失败')\n            }\n        },\n        moreChannels () {\n            this.isChannelShow = true\n        },\n        onUpdateChange (index, onShow = false) {     //更改标签栏的显示 \n            //()里面的参数，如果直接在里面设置就是默认值，子组件传了这个参数就使用传过来的，没有传值就使用默认值这是es6的新语法\n            this.active = index\n            this.isChannelShow = onShow\n        }\n    }\n}\n</script>\n\n<style scoped lang=\"less\">\n.home {\n    padding-bottom: 100px;\n    padding-top: 177px;\n    .search_btn {\n        width: 555px;\n        height: 64px;\n        background-color: #5babfb;\n        font-size: 28px;\n        .van-icon {\n            font-size: 32px;\n        }\n    }\n\n    // /deep/ 深度操作服务，可以使后面的子代受到影响\n    /deep/ .channel-tabs {\n        \n        .van-tabs__wrap {\n            height: 83px;\n            position: fixed;\n            top: 92px;\n            z-index: 1;\n            left: 0;\n            right: 0;\n        }\n        .van-tab {\n            border-right: 1px solid #edeff3;\n            min-width: 190px;\n            font-size: 30px;\n            color: #777777;\n        }\n        .van-tab--active {\n            color: #333333;\n        }\n\n        .van-tabs__nav {\n            padding-bottom: 0;\n        }\n\n        .van-tabs__line {\n            width: 31px !important;\n            bottom: 9px;\n            height: 6px;\n            background-color: #3296fa;\n        }\n        \n        .more-btn {\n            position: fixed;\n            right: 0;\n            width: 66px;\n            height: 83px;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            background-color: #fff;\n            opacity: 0.9;\n            i {\n                font-size: 33px;\n                color: #333333;\n            }\n            &:before {\n                content: \"\";\n                position: absolute;\n                left: 0;\n                width: 1px;\n                height: 58px;\n                background: url(~@/assets/gradient-gray-line.png);\n                background-size: contain;\n            }\n        }\n\n        .placeholder {\n            width: 50px;\n            height: 83px;\n            flex-shrink: 0;\n        }\n    }\n}\n\n    \n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=9fedac84&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=9fedac84&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9fedac84\",\n  null\n  \n)\n\nexport default component.exports","//文章请求模块\nimport request from '@/utils/request'\n\n//请求获取文章列表数据\nexport const getArticles = params => request({\n    method : 'get',\n    url : '/v1_0/articles',\n    params\n})\n\n//请求获取文章详情\nexport const getArticleDetail = articleId => request({\n    method : 'get',\n    url : `/v1_0/articles/${articleId}`\n}) \n\n//请求收藏文章\nexport const collectArticles = target => request({\n    method : 'post',\n    url : '/v1_0/article/collections',\n    data : {\n        target,\n    }\n})\n\n//请求取消收藏文章\nexport const cancalCollectArticles = target => request({\n    method : 'delete',\n    url : `/v1_0/article/collections/${target}`\n})\n\n//请求点赞文章\nexport const likeArticles = target => request({\n    method : 'post',\n    url : '/v1_0/article/likings',\n    data : {\n        target,\n    }\n})\n\n//请求取消对文章点赞\nexport const cancalLikeArticles = target => request({\n    method : 'delete',\n    url : `/v1_0/article/likings/${target}`\n})"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","model","value","callback","$$v","active","expression","_l","obj","key","id","name","on","moreChannels","style","height","isChannelShow","channels","onUpdateChange","staticRenderFns","$event","iconState","_s","index","onMyChannelBtn","directives","rawName","fiexdChannels","includes","class","activecss","item","onAddChannel","getAllChannels","request","method","url","addUserChannels","channel","data","deleteUserChannels","channelId","props","myChannels","type","required","allChannels","methods","console","seq","setItem","computed","component","newSuccessText","onRefresh","isNewLoading","finished","onLoad","loading","article","title","cover","img","ind","_e","aut_name","comm_count","_f","pubdate","images","list","timestamp","error","channel_id","components","ArticleItem","ChannelEdit","getArticles","params","getArticleDetail","articleId","collectArticles","target","cancalCollectArticles","likeArticles","cancalLikeArticles"],"sourceRoot":""}