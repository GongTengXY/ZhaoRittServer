{"version":3,"file":"js/292.93b5b27a.js","mappings":"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","sources":["webpack://hmtoutiao/./src/views/Login/index.vue?4f40","webpack://hmtoutiao/src/views/Login/index.vue","webpack://hmtoutiao/./src/views/Login/index.vue?93c6","webpack://hmtoutiao/./src/views/Login/index.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('van-nav-bar',{staticClass:\"page-nav-bar\",attrs:{\"title\":\"登录\"}},[_c('van-icon',{attrs:{\"slot\":\"left\",\"name\":\"arrow-left\",\"size\":\"16\"},on:{\"click\":function($event){return _vm.$router.push({path : '/layout/my'})}},slot:\"left\"})],1),_c('van-form',{ref:\"loginUser\",on:{\"submit\":_vm.onSubmit}},[_c('van-field',{attrs:{\"name\":\"mobile\",\"placeholder\":\"请输入手机号\",\"rules\":_vm.loginRules.mobile,\"maxlength\":\"11\"},model:{value:(_vm.user.mobile),callback:function ($$v) {_vm.$set(_vm.user, \"mobile\", $$v)},expression:\"user.mobile\"}},[_c('i',{staticClass:\"iconfont icon-shouji\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"})]),_c('van-field',{attrs:{\"type\":\"password\",\"name\":\"密码\",\"placeholder\":\"请输入验证码\",\"rules\":_vm.loginRules.code,\"maxlength\":\"6\"},scopedSlots:_vm._u([{key:\"button\",fn:function(){return [(_vm.showTime)?_c('van-count-down',{attrs:{\"time\":60 * 1000,\"format\":\"ss 秒\"},on:{\"finish\":function($event){_vm.showTime = false}}}):_c('van-button',{staticClass:\"yanzhengma\",attrs:{\"round\":\"\",\"size\":\"small\",\"type\":\"primary\",\"native-type\":\"button\"},on:{\"click\":_vm.Onsend}},[_vm._v(\"获取验证码\")])]},proxy:true}]),model:{value:(_vm.user.code),callback:function ($$v) {_vm.$set(_vm.user, \"code\", $$v)},expression:\"user.code\"}},[_c('i',{staticClass:\"iconfont icon-yanzhengma\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"})]),_c('div',{staticStyle:{\"margin\":\"16px\"}},[_c('van-button',{attrs:{\"round\":\"\",\"block\":\"\",\"type\":\"info\",\"native-type\":\"submit\"}},[_vm._v(\"登录\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <!-- 导航栏 -->\n   <van-nav-bar title=\"登录\" class=\"page-nav-bar\">\n     <van-icon name=\"arrow-left\" slot=\"left\"  size=\"16\" @click=\"$router.push({path : '/layout/my'})\"/>\n   </van-nav-bar>\n\n   <!-- 表单 -->\n  <van-form @submit=\"onSubmit\"   ref=\"loginUser\">\n    <van-field\n      v-model=\"user.mobile\"\n      name=\"mobile\"\n      placeholder=\"请输入手机号\"\n      :rules=\"loginRules.mobile\"\n      maxlength=11>\n    <i slot=\"left-icon\" class=\"iconfont icon-shouji\"></i>\n    </van-field>\n    <van-field\n      v-model=\"user.code\"\n      type=\"password\"\n      name=\"密码\"\n      placeholder=\"请输入验证码\"\n      :rules=\"loginRules.code\"\n      maxlength=6>\n      <i slot=\"left-icon\" class=\"iconfont icon-yanzhengma\"></i>\n      <template #button>\n        <van-count-down :time=\"60 * 1000\" @finish=\"showTime = false\" format=\"ss 秒\" v-if=\"showTime\"/>\n        <van-button class=\"yanzhengma\" v-else round size=\"small\" type=\"primary\" @click=\"Onsend\" native-type=\"button\">获取验证码</van-button>\n      </template>\n      </van-field>\n    <div style=\"margin: 16px;\">\n      <van-button round block type=\"info\" native-type=\"submit\">登录</van-button>\n    </div>\n  </van-form>\n  </div>\n</template>\n\n<script>\nimport {login, sendCode} from '@/api/user'\nexport default {\n  name : 'Login',\n  data () {\n    return {\n      user : {\n        mobile : '',   //手机号\n        code : '',     //验证码\n        //账号：13911111111\n        //密码：246810\n      },\n      loginRules : {\n        mobile : [{ \n          required: true,\n          message: '请填写用户名'\n          },\n          {\n            pattern : /^1[3|4|5|6|7|8|9][0-9]{9}$/,\n            message : '用户名格式错误'\n          }],\n        code : [{ \n          required: true,\n          message: '请填写用户名' \n          },\n          {\n            pattern : /^\\d{6}$/,\n            message : '验证码格式错误'\n          }]\n      },  \n      showTime : false,  //是否展示倒计时\n    }\n  },\n  methods: {\n    //登录验证\n    async onSubmit() {\n      //1.获取表单数据\n      const user = this.user\n      //2.表单验证\n\n      //在组件中要用this.$toast调用\n      this.$toast.loading({\n        message: '登录中...',\n        forbidClick: true,  //禁止点击其他\n        duration : 0,  //如果为0，则持续展示\n      });\n      //3.提交表单请求登录\n      try {\n        const res = await login(user)\n        const data = res.data.data\n        this.$toast.success('登录成功')\n        this.$store.commit('setUser', data.token)\n        localStorage.setItem('refresh_token', data.refresh_token)\n        // console.log('登录成功', res)\n        //登录成功，跳转回原来页面 使用back不严谨，后面再说\n        this.$router.back()\n      } catch(err){\n        if (err.response.status === 400){\n          this.$toast.fail('手机号或验证码错误')\n          // console.log('手机号或验证码错误')\n        } else {\n          this.$toast.fail('登录失败，请稍后重试')\n          // console.log(\"登录失败，请稍后重试\")\n        }\n      }\n      //4.根据请求响应结果处理后续操作\n      \n    },\n    async Onsend() {\n      //1.要先校验手机号码\n      try{\n        //vant中的属性validate可以验证单个表单项\n        await this.$refs.loginUser.validate(\"mobile\")\n      } catch(err) {\n        return console.log('验证失败', err)\n      }\n      //2.验证通过，显示倒计时\n      this.showTime = true\n      //3.请求发送验证码 -- 调用接口接口就好\n      try{\n        await sendCode(this.user.mobile)\n        this.$toast.success('发送成功')\n      } catch {\n        this.showTime = false\n        if (err.response.status === 429) {\n          this.$toast('发送频繁，请稍后重试');\n        } else {\n          this.$toast('发送失败，请稍后重试')\n        }\n      }\n    },\n  },\n}\n</script>\n\n<style lang=\"less\" scoped>\n  .van-form {\n    .van-cell {\n        line-height: 90px;\n        padding: 20px 40px;\n        .iconfont {\n            font-size: 36px;\n            margin-right: 20px;\n        }\n        .yanzhengma {\n          width: 158px;\n          height: 46px;\n          background-color: #ededed;\n          color: #000;\n          border: none;\n        }\n    }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=6fd120d7&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=6fd120d7&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6fd120d7\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","push","path","slot","ref","onSubmit","loginRules","mobile","model","value","user","callback","$$v","$set","expression","code","scopedSlots","_u","key","fn","showTime","Onsend","_v","proxy","staticStyle","staticRenderFns","name","data","required","message","pattern","methods","async","$toast","loading","forbidClick","duration","res","success","$store","commit","token","localStorage","setItem","refresh_token","back","err","response","status","fail","$refs","loginUser","validate","console","log","component"],"sourceRoot":""}